# RCGen Configuration

RCGen can be configured using the `.rcgen.toml` file in the root repository. This document describes all available configuration options.

## Creating a Configuration File

Use the `init` command to create a default configuration file:

```bash
rcgen init
```

This will create a `.rcgen.toml` file with the default configuration. Use `--force` to overwrite existing files:

```bash
rcgen init --force
```

## Configuration Structure

The configuration file uses TOML format and has the following structure:

```toml
[repository]
url = "https://github.com/username/repository"
default_branch = "main"
tag_pattern = "v[0-9]+.*"

[output]
default_format = "md"
exclude_merges = true
include_body = false
include_diff_stats = true
max_commits = 100
show_short_hash = true
show_author = true
show_date = true

[filters]
exclude_authors = [ "bot@example.com", "dependabot[bot]" ]
exclude_patterns = [ "^Merge", "^Revert", "^WIP" ]
include_patterns = [ ]
since_date = ""
until_date = ""

[grouping]
enabled = true
default_group_name = "Other Changes"

[[grouping.groups]]
name = "Features"
patterns = [ "^feat:", "adds?", "new", "implement" ]
description = "New features and enhancements"
emoji = ""

[[grouping.groups]]
name = "Bug Fixes"
patterns = [ "^fix:", "bug", "issue", "error" ]
description = "Bug fixes and patches"
emoji = ""

[[grouping.groups]]
name = "Documentation"
patterns = [ "^docs:", "doc(?:s|umentation)?", "readme" ]
description = "Documentation updates"
emoji = ""

[[grouping.groups]]
name = "Refactoring"
patterns = [ "^refactor:", "cleanup", "restructure" ]
description = "Code refactoring"
emoji=""

[[grouping.groups]]
name = "Performance"
patterns = [ "^perf:", "optimize", "speed", "performance" ]
description = "Performance improvements"
emoji=""

[[grouping.groups]]
name = "Tests"
patterns = [ "^test:", "^tests:", "coverage" ]
description = "Test updates"
emoji = ""

[[grouping.groups]]
name = "Chores"
patterns = [ "^chore:", "^ci:", "^build:", "deps", "dependency" ]
description = "Maintenance tasks"
emoji = ""

[[grouping.groups]]
name = "Style"
patterns = [ "^style:", "formatting", "lint" ]
description = "Code style changes"
emoji = ""

[templates]
header = """
# Changelog

All notable changes to this project will be documented in this file.
"""
footer = """
---
Generated by [RCGen](https://github.com/neuxdotdev/rcgen)"""
commit_format = "- {emoji} {message} (`{short_hash}` by {author} on {date})"
date_format = "%Y-%m-%d"
time_format = "%H:%M"
date_group_format = "##{date}"
include_diff_in_commit = true
diff_format = " - {files_changed} files changed (+{insertions}/-{deletions})"

[stats]
enabled = true
show_bus_factor = true
show_activity_heatmap = false
show_top_contributors = 5
show_commit_types = true
show_timeline = true

[release]
auto_detect_versions = true
version_pattern = "^v?[0-9]+\\.[0-9]+\\.[0-9]+"
group_by_version = true
include_prereleases = false
```

## Explanation of the Configuration Section

### 1. `[repository]`

| Parameters       | Type    | Default       | Description                         |
| ---------------- | ------- | ------------- | ----------------------------------- |
| `url`            | strings | `""`          | Repository URL for reference        |
| `default_branch` | strings | `"play"`      | Branch default repository           |
| `tag_pattern`    | strings | `"v[0-9]+.*"` | Regex pattern to detect version tag |

**Example:**

```toml
[repository]
url="https://github.com/neuxdotdev/rcgen"
default_branch = "main"
tag_pattern = "v[0-9]+\\.[0-9]+\\.[0-9]+(-[a-zA-Z0-9]+)?"
```

### 2. `[output]`

| Parameters           | Type    | Default | Description                                  |
| -------------------- | ------- | ------- | -------------------------------------------- |
| `default_format`     | strings | `"md"`  | Default output format (`md`, `json`, `text`) |
| `exclude_merges`     | boolean | `true`  | Exclude merge commits                        |
| `include_body`       | boolean | `false` | Include commit body                          |
| `include_diff_stats` | boolean | `true`  | Include diff statistics                      |
| `max_commits`        | integer | `100`   | Maximum commits processed                    |
| `show_short_hash`    | boolean | `true`  | Show short hash                              |
| `show_author`        | boolean | `true`  | Show author                                  |
| `show_date`          | boolean | `true`  | Show date                                    |

### 3. `[filters]`

| Parameter          | Type   | Default                 | Description                      |
| ------------------ | ------ | ----------------------- | -------------------------------- |
| `exclude_authors`  | array  | `[]`                    | List of authors to exclude       |
| `exclude_patterns` | array  | `["^Merge", "^Revert"]` | Regex pattern to exclude commits |
| `include_patterns` | array  | `[]`                    | Regex pattern to include commits |
| `since_date`       | string | `""`                    | Filter since date (YYYY-MM-DD)   |
| `until_date`       | string | `""`                    | Filter until date                |

**Example of a Complex Filter:**

```toml
[filters]
exclude_authors = [
"bot@example.com",
"dependabot[bot]",
"renovate[bot]"
]
exclude_patterns = [
"^merge branches",
"^Revert",
"^WIP",
"^skip ci"
]
include_patterns = [
"^feat:",
"^fix:",
"^BREAKING CHANGE:"
]
since_date = "2024-01-01"
until_date = "2024-12-31"
```

### 4. `[grouping]`

Configure commit grouping based on a pattern.

| Parameter            | Type    | Default           | Description                      |
| -------------------- | ------- | ----------------- | -------------------------------- |
| `enabled`            | boolean | `true`            | Enable/disable grouping          |
| `default_group_name` | string  | `"Other Changes"` | Group name for unmatched commits |

**Group Configuration:**
Each group has parameters:

- `name`: Group name
- `patterns`: Array of regex patterns
- `description`: Group description (optional)
- `emoji`: Emoji for groups (optional)

**Example of Custom Groups:**

```toml
[grouping]
enabled = true
default_group_name = "Miscellaneous"

[[grouping.groups]]
name = "Security"
patterns = [ "^security:", "CVE", "vulnerability" ]
description = "Security updates and fixes"
emoji = ""

[[grouping.groups]]
name = "Accessibility"
patterns = [ "^a11y:", "accessibility" ]
description = "Accessibility improvements"
emoji=""

[[grouping.groups]]
name = "Internationalization"
patterns = [ "^i18n:", "translation", "locale" ]
description = "Internationalization updates"
emoji = ""
```

### 5. `[templates]`

Customize output templates.

| Parameters               | Type    | Default                              | Description            |
| ------------------------ | ------- | ------------------------------------ | ---------------------- |
| `header`                 | strings | `"#Changelog\n\n"`                   | Template headers       |
| `footer`                 | strings | `""`                                 | Footer templates       |
| `commit_format`          | strings | `"- {message} ({hash})"`             | Format of each commit  |
| `date_format`            | strings | `"%Y-%m-%d"`                         | Date format            |
| `time_format`            | strings | `"%H:%M"`                            | Time format            |
| `date_group_format`      | strings | `"##{date}"`                         | Date group format      |
| `include_diff_in_commit` | boolean | `true`                               | Include diff in commit |
| `diff_format`            | strings | `" - {files_changed} files changed"` | Diff statistics format |

**Available Placeholders:**

- `{message}`: Commit message
- `{hash}`: Full commit hash
- `{short_hash}`: Short commit hash (7 characters)
- `{author}`: Author name
- `{author_email}`: Author email
- `{date}`: Commit date
- `{time}`: Commit time
- `{emoji}`: Group emoji
- `{files_changed}`: Number of files changed
- `{insertions}`: Lines added
- `{deletions}`: Lines removed
- `{branch}`: Branch name
- `{tags}`: Tags (if any)

**Example Custom Template:**

```toml
[templates]
header = """
#  Changelog - {repository_name}

> Generated: {generated_date}
> Repository: {repository_url}

"""
footer = """
---
 **Links**
- [Repository]({repository_url})
- [Issues]({repository_url}/issues)
- [Releases]({repository_url}/releases)

*Changelog generated with  using [RCGen](https://github.com/neuxdotdev/rcgen)*
"""
commit_format = " {emoji} **{message}**\n -  {author} |  {date} {time} |  `{short_hash}`"
date_group_format = "##  {date}\n"
```

### 6. `[stats]`

Statistics configuration.

| Parameter               | Type    | Default | Description                           |
| ----------------------- | ------- | ------- | ------------------------------------- |
| `enabled`               | boolean | `true`  | Show statistics                       |
| `show_bus_factor`       | boolean | `true`  | Show bus factor                       |
| `show_activity_heatmap` | boolean | `false` | Show activity heatmap                 |
| `show_top_contributors` | integer | `5`     | Number of top contributors to display |
| `show_commit_types`     | boolean | `true`  | Show commit type distribution         |
| `show_timeline`         | boolean | `true`  | Show activity timeline                |

### 7. `[release]`

Special configuration for release notes.

| Parameter              | Type    | Default                         | Description                    |
| ---------------------- | ------- | ------------------------------- | ------------------------------ |
| `auto_detect_versions` | boolean | `true`                          | Auto-detect versions from tags |
| `version_pattern`      | string  | `"^v?[0-9]+\\.[0-9]+\\.[0-9]+"` | Pattern for versions           |
| `group_by_version`     | boolean | `true`                          | Group commits by version       |
| `include_prereleases`  | boolean | `false`                         | Include pre-releases           |

## Complete Configuration Example

Here's a complete configuration example for a production project:

```toml
[repository]
url = "https://github.com/acme/project"
default_branch = "main"
tag_pattern = "^v[0-9]+\\.[0-9]+\\.[0-9]+(-(alpha|beta|rc)\\.[0-9]+)?"

[output]
default_format = "md"
exclude_merges = true
include_body = true
include_diff_stats = true
max_commits = 500
show_short_hash = true
show_author = true
show_date = true

[filters]
exclude_authors = [
"dependabot[bot]",
"renovate[bot]",
"github-actions[bot]"
]
exclude_patterns = [
"^Merge",
"^Revert",
"^WIP",
"\\[skip ci\\]",
"\\[no-changelog\\]"
]
include_patterns = []
since_date = ""
until_date = ""

[grouping]
enabled = true
default_group_name = "Other Changes"

[[grouping.groups]]
name = " Features"
patterns = ["^feat:", "^feature:", "adds?", "new", "implement"]
description = "New features and enhancements"

[[grouping.groups]]
name = " Bug Fixes"
patterns = ["^fix:", "bug", "issue", "error", "resolve"]
description = "Bug fixes and patches"

[[grouping.groups]]
name = " Documentation"
patterns = ["^docs:", "documentation", "readme", "javadoc"]
description = "Documentation updates"

# ... add more groups

[templates]
header = """
# Changelog - ACME Project

All notable changes to this project will be documented in this file.

"""
footer = """
---
*This changelog is automatically generated by [RCGen](https://github.com/neuxdotdev/rcgen)*
"""
commit_format = "- {emoji} **{message}** (`{short_hash}` by {author})"
date_format = "%B %d, %Y"
date_group_format = "##{date}\n"
include_diff_in_commit = true
diff_format = " - {files_changed} files changed (+{insertions}/-{deletions})"

[stats]
enabled = true
show_bus_factor = true
show_top_contributors = 10
show_commit_types = true

[release]
auto_detect_versions = true
version_pattern = "^v[0-9]+\\.[0-9]+\\.[0-9]+"
group_by_version = true
include_prereleases = false
```

## Using Multiple Configurations

You can have multiple configurations by using environment variables:

```bash
# Use custom configurations
RCGEN_CONFIG=./config/rcgen.prod.toml rcgen gen

# Or with the flag
rcgen gen --config ./config/rcgen.prod.toml
```

## Configuration Priorities

RCGen uses the following priorities (from highest to lowest):

1. Command-line arguments
2. Environment variables
3. Local `.rcgen.toml` file
4. Global `~/.config/rcgen/config.toml`
5. Default values

## Tips and Best Practices

### 1. Ignore Git Configuration File

Add to `.gitignore`:

```
.rcgen.toml
```

### 2. Team Template

Create a `rcgen.template.toml` file with the basic configuration and save it to the repository.

### 3. Environment-Specific Config

Use environment variables for different configurations:

```bash
# In the shell
export RCGEN_MAX_COMMITS=1000
export RCGEN_EXCLUDE_AUTHORS="bot@example.com"

# Or in the .env file
RCGEN_MAX_COMMITS=1000
RCGEN_EXCLUDE_AUTHORS="bot@example.com"
```

### 4. Auto-Generated Config

Integrate with the build system:

```bash
# Generate config from template
envsubst < rcgen.template.toml > .rcgen.toml
```

## Configuration Debugging

To debug the configuration in use:

```bash
# Show the active configuration
rcgen config show

# Validate the configuration
rcgen config validate

# Test the configuration with a sample commit
rcgen config test
```

## Next Steps

- See [Home](../home.md) for usage examples
- See [Installation](./install.md) for installation instructions
